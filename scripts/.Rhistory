st_buffer(1) %>%
st_centroid()
return(output)
}
babadook <- split(pt_grps, ~CAST_ID)
new_centers <- lapply(lapply(babadook, center_windows), pts_cell) %>% bind_rows()
center_windows <- function(x){
output <- x %>%
st_as_sf() %>%
st_union() %>%
st_convex_hull() %>%
st_transform(32613) %>%
st_buffer(1) %>%
st_centroid()
return(output)
}
babadook <- split(pt_grps, ~CAST_ID)
new_centers <- lapply(lapply(babadook, center_windows), pts_cell) %>% bind_rows()
ggplot() +
geom_sf(data = new_centers, alpha = 0.2, fill = 'red') +
geom_sf(data = tp) +
theme_bw()
test <-data.table::rbindlist(lapply(babadook, center_windows)) %>% tibble()
View(test)
colnames(test) <- 'geometry'
sf <- test %>% st_as_sf(sf_column_name = geometry)
test <- lapply(babadook, center_windows) %>% tibble()
View(test)
colnames(test) <- 'geometry'
sf <- test %>% st_as_sf(sf_column_name = geometry)
test <- lapply(babadook, center_windows) %>% tibble() %>% st_as_sf()
center_windows <- function(x){
output <- x %>%
st_as_sf() %>%
st_union() %>%
st_convex_hull() %>%
st_transform(32613) %>%
st_buffer(1) %>%
st_centroid()
return(output)
}
test <- lapply(babadook, center_windows) %>% tibble()
test <- lapply(babadook, center_windows) %>% bind_rows()
tibble() %>% st
test <- lapply(babadook, center_windows) %>% tibble()
new_centers <- lapply(lapply(babadook, center_windows), pts_cell) %>% bind_rows()
View(new_centers)
View(pts_cell)
center_windows <- function(x){
output <- x %>%
st_as_sf() %>%
st_union() %>%
st_convex_hull() %>%
st_transform(32613) %>%
st_buffer(1) %>%
st_centroid()
return(output)
}
new_centers <- lapply(lapply(babadook, center_windows), pts_cell) %>% bind_rows()
ggplot() +
geom_sf(data = new_centers, alpha = 0.2, fill = 'red') +
geom_sf(data = tp) +
theme_bw()
center_windows <- function(x){
output <- x %>%
st_as_sf() %>%
st_union() %>%
st_convex_hull() #%>%
#st_transform(32613) %>%
#st_buffer(1) %>%
#st_centroid()
return(output)
}
test <- lapply(babadook, center_windows) %>% tibble()
sf <- test %>% st_as_sf(sf_column_name = geometry)
center_windows <- function(x){
output <- x %>%
st_as_sf() %>%
st_union() %>%
st_convex_hull() #%>%
#st_transform(32613) %>%
#st_buffer(1) %>%
#st_centroid()
return(output)
}
center_windows <- function(x){
output <- x %>%
st_as_sf() %>%
st_union() %>%
st_convex_hull() %>%
st_as_sf()
#st_transform(32613) %>%
#st_buffer(1) %>%
#st_centroid()
return(output)
}
test <- lapply(babadook, center_windows) %>% tibble()
test <- lapply(babadook, center_windows) %>% tibble() %>% st_as_sf()
View(test)
test <- lapply(babadook, center_windows) %>% st_as_sf()
View(test)
center_windows <- function(x){
output <- x %>%
st_as_sf() %>%
st_union() %>%
st_convex_hull() %>%
st_as_sf()
#st_transform(32613) %>%
#st_buffer(1) %>%
#st_centroid()
return(output)
}
babadook <- split(pt_grps, ~CAST_ID)
new_centers <- lapply(lapply(babadook, center_windows), pts_cell) %>% bind_rows()
test <- lapply(babadook, center_windows) %>% st_as_sf()
colnames(test) <- 'geometry'
ggplot() +
geom_sf(data = new_centers, alpha = 0.2, fill = 'red') +
geom_sf(data = tp) +
theme_bw()
center_windows <- function(x){
output <- x %>%
st_as_sf() %>%
st_union() %>%
st_convex_hull() %>%
st_as_sf() %>%
st_transform(32613) %>%
st_buffer(1) %>%
st_centroid()
return(output)
}
center_windows <- function(x){
output <- x %>%
st_as_sf() %>%
st_union() %>%
st_convex_hull() %>%
st_transform(32613) %>%
st_buffer(1) %>%
st_centroid() %>%
st_as_sf()
return(output)
}
babadook <- split(pt_grps, ~CAST_ID)
new_centers <- lapply(lapply(babadook, center_windows), pts_cell) %>% bind_rows()
ggplot() +
geom_sf(data = new_centers, alpha = 0.2, fill = 'red') +
geom_sf(data = tp) +
theme_bw()
View(pts_cell)
center_windows <- function(x){
output <- x %>%
st_as_sf() %>%
st_union() %>%
st_convex_hull() %>%
st_transform(32613) %>%
st_buffer(1) %>%
st_centroid() %>%
st_as_sfc() %>%
st_as_sf()
return(output)
}
new_centers <- lapply(lapply(babadook, center_windows), pts_cell) %>% bind_rows()
center_windows <- function(x){
output <- x %>%
st_as_sf() %>%
st_union() %>%
st_convex_hull() %>%
st_transform(32613) %>%
st_buffer(1) %>%
st_centroid() %>%
#    st_as_sfc() %>%
st_as_sf()
return(output)
}
new_centers <- lapply(lapply(babadook, center_windows), pts_cell) %>% bind_rows()
View(test)
View(new_centers)
center_windows <- function(x){
output <- x %>%
st_as_sf() %>%
st_union() %>%
st_convex_hull() %>%
st_transform(32613) %>%
st_buffer(1) %>%
st_centroid() %>%
st_as_sf()
return(output)
}
test <- lapply(babadook, center_windows)
View(test)
View(test[["1"]])
View(test[["1"]])
test <- lapply(babadook, center_windows) %>% bind_rows()
View(test)
ggplot() +
geom_sf(data = new_centers, alpha = 0.2, fill = 'red') +
geom_sf(data = tp) +
theme_bw()
ggplot() +
geom_sf(data = test, alpha = 0.2, fill = 'red') +
geom_sf(data = tp) +
theme_bw()
new_centers
View(test)
ggplot() +
geom_sf(data = test, alpha = 0.2, fill = 'red') +
geom_sf(data = tp) +
theme_bw()
center_windows <- function(x){
output <- x %>%
st_as_sf() %>%
st_union() %>%
st_convex_hull() %>%
st_transform(32613) %>%
st_buffer(1) %>%
st_point_on_surface() %>%
st_as_sf()
return(output)
}
test <- lapply(babadook, center_windows) %>% bind_rows()
ggplot() +
geom_sf(data = test, alpha = 0.2, fill = 'red') +
geom_sf(data = tp) +
theme_bw()
output <- x %>%
st_as_sf() %>%
st_union() %>%
st_convex_hull() %>%
st_transform(32613) %>%
st_buffer(1) %>%
st_centroid() %>%
st_as_sf()
center_windows <- function(x){
output <- x %>%
st_as_sf() %>%
st_union() %>%
st_convex_hull() %>%
st_transform(32613) %>%
st_buffer(1) %>%
st_centroid() %>%
st_as_sf()
return(output)
}
ggplot() +
geom_sf(data = test, alpha = 0.2, fill = 'red') +
geom_sf(data = tp) +
theme_bw()
center_windows <- function(x){
output <- x %>%
st_as_sf() %>%
st_union() %>%
st_convex_hull() %>%
st_cast('POLYGON') %>%
st_transform(32613) %>%
st_buffer(1) %>%
st_centroid() %>%
st_as_sf()
return(output)
}
test <- lapply(babadook, center_windows) %>% bind_rows()
center_windows <- function(x){
output <- x %>%
st_as_sf() %>%
st_union() %>%
st_convex_hull() %>%
st_transform(32613) %>%
st_buffer(1) %>%
st_cast('POLYGON') %>%
st_centroid() %>%
st_as_sf()
return(output)
}
test <- lapply(babadook, center_windows) %>% bind_rows()
ggplot() +
geom_sf(data = test, alpha = 0.2, fill = 'red') +
geom_sf(data = tp) +
theme_bw()
center_windows <- function(x){
output <- x %>%
st_as_sf() %>%
st_union() %>%
st_convex_hull() %>%
st_transform(32613) %>%
st_buffer(1) %>%
st_cast('POLYGON') %>%
#st_centroid() %>%
st_as_sf()
return(output)
}
test <- lapply(babadook, center_windows) %>% bind_rows()
colnames(test) <- 'geometry'
ggplot() +
geom_sf(data = test, alpha = 0.2, fill = 'red') +
geom_sf(data = tp) +
theme_bw()
test <- lapply(babadook, center_windows) %>% bind_rows()
ggplot() +
geom_sf(data = test, alpha = 0.2, fill = 'red') +
geom_sf(data = tp) +
theme_bw()
center_windows <- function(x){
output <- x %>%
st_as_sf() %>%
st_union() %>%
st_convex_hull() %>%
#st_transform(32613) %>%
#st_buffer(1) %>%
#st_cast('POLYGON') %>%
#st_centroid() %>%
st_as_sf()
return(output)
}
test <- lapply(babadook, center_windows) %>% bind_rows()
ggplot() +
geom_sf(data = test, alpha = 0.2, fill = 'red') +
geom_sf(data = tp) +
theme_bw()
View(babadook)
center_windows <- function(x){
output <- x %>%
st_as_sf() %>%
st_union() %>%
st_convex_hull() %>%
st_transform(32613) %>%
st_buffer(1) %>%
st_cast('POLYGON') %>%
st_centroid() %>%
st_as_sf()
return(output)
}
new_centers <- lapply(lapply(babadook, center_windows), pts_cell) %>% bind_rows()
ggplot() +
geom_sf(data = new_centers, alpha = 0.2, fill = 'red') +
geom_sf(data = tp) +
theme_bw()
View(pt_grps)
View(pts_cell)
ggplot() +
geom_sf(data = new_centers, alpha = 0.2, fill = 'red') +
geom_sf(data = pts) +
theme_bw()
pt_grps <- st_intersection(pts, new_polys) %>%
group_by(CAST_ID)
center_windows <- function(x){
output <- x %>%
st_as_sf() %>%
st_union() %>%
st_convex_hull() %>%
st_transform(32613) %>%
st_buffer(1) %>%
st_cast('POLYGON') %>%
st_centroid() %>%
st_as_sf()
return(output)
}
babadook <- split(pt_grps, ~CAST_ID)
new_centers <- lapply(lapply(babadook, center_windows), pts_cell) %>% bind_rows()
test <- lapply(babadook, center_windows) %>% bind_rows()
test <- lapply(babadook, center_windows) %>% bind_rows()
colnames(test) <- 'geometry'
sf <- test %>% st_as_sf(sf_column_name = geometry)
ggplot() +
geom_sf(data = new_centers, alpha = 0.2, fill = 'red') +
geom_sf(data = pts) +
theme_bw()
ggplot() +
geom_sf(data = test, alpha = 0.2, fill = 'red') +
geom_sf(data = pts) +
theme_bw()
tp <- out %>%
ungroup() %>%
group_by(PL_ID) %>%
tally() %>%
filter(n >1)
new_polys <-st_join(polys1, tp, left = F) %>%
distinct(POLY_ID, .keep_all = T) %>%
st_union() %>%
st_cast("POLYGON") %>%
st_as_sf() %>%
mutate(CAST_ID = 1:nrow(.))
ggplot() +
geom_sf(data = new_centers, alpha = 0.2, fill = 'red') +
geom_sf(data = pts) +
theme_bw()
ggplot() +
geom_sf(data = new_centers, alpha = 0.2, fill = 'red') +
geom_sf(data = tp) +
theme_bw()
View(tp)
View(pt_grps)
ggplot() +
geom_sf(data = new_centers, alpha = 0.2, fill = 'red') +
geom_sf(data = pts) +
theme_bw()
center_windows(x,y){
center_windows(x,y, z){
center_windows(x,y){
center_windows <- function(x,y){
x <- x %>% mutate(PL_ID = 1:nrow(.))
pts_2_new_poly <- st_intersection(x, polys1)
tp <- pts_2_new_poly %>%
ungroup() %>%
group_by(PL_ID) %>%
tally() %>%
filter(n >1)
# 1 - Intersect all points to the remaining cells.
# 2 - determine which points are present in multiple windows
# 3 - if a cell does NOT contain any novel points - drop it
new_polys <-st_join(polys1, tp, left = F) %>%
distinct(POLY_ID, .keep_all = T) %>%
st_union() %>%
st_cast("POLYGON") %>%
st_as_sf() %>%
mutate(CAST_ID = 1:nrow(.))
pt_grps <- st_intersection(pts, new_polys) %>%
group_by(CAST_ID)
center_windows <- function(x){
output <- x %>%
st_as_sf() %>%
st_union() %>%
st_convex_hull() %>%
st_transform(32613) %>%
st_buffer(1) %>%
st_cast('POLYGON') %>%
st_centroid() %>%
st_as_sf()
return(output)
}
babadook <- split(pt_grps, ~CAST_ID)
new_centers <- lapply(lapply(babadook, center_windows), pts_cell) %>% bind_rows()
return(new_centers)
}
lapply(pts, polys1, center_windows)
lapply(x = pts, y =  polys1, center_windows)
lapply(x = pts, y =  polys1, FUN = center_windows)
mapply(x = pts, y =  polys1, FUN = center_windows)
mapply( pts, FUN = center_windows, arg1 = polys1)
lapply( pts, FUN = center_windows, arg1 = polys1)
mapply(center_windows, pts, polys1)
center_windows <- function(x){
x <- x %>% mutate(PL_ID = 1:nrow(.))
pts_2_new_poly <- st_intersection(x, polys1)
tp <- pts_2_new_poly %>%
ungroup() %>%
group_by(PL_ID) %>%
tally() %>%
filter(n >1)
# 1 - Intersect all points to the remaining cells.
# 2 - determine which points are present in multiple windows
# 3 - if a cell does NOT contain any novel points - drop it
new_polys <-st_join(polys1, tp, left = F) %>%
distinct(POLY_ID, .keep_all = T) %>%
st_union() %>%
st_cast("POLYGON") %>%
st_as_sf() %>%
mutate(CAST_ID = 1:nrow(.))
pt_grps <- st_intersection(pts, new_polys) %>%
group_by(CAST_ID)
center_windows <- function(x){
output <- x %>%
st_as_sf() %>%
st_union() %>%
st_convex_hull() %>%
st_transform(32613) %>%
st_buffer(1) %>%
st_cast('POLYGON') %>%
st_centroid() %>%
st_as_sf()
return(output)
}
babadook <- split(pt_grps, ~CAST_ID)
new_centers <- lapply(lapply(babadook, center_windows), pts_cell) %>% bind_rows()
return(new_centers)
}
lapply(pts, center_windows)
center_windows <- function(x){
x <- x %>% mutate(PL_ID = 1:nrow(.))
pts_2_new_poly <- st_intersection(x, polys1)
tp <- pts_2_new_poly %>%
ungroup() %>%
group_by(PL_ID) %>%
tally() %>%
filter(n >1)
# 1 - Intersect all points to the remaining cells.
# 2 - determine which points are present in multiple windows
# 3 - if a cell does NOT contain any novel points - drop it
new_polys <-st_join(polys1, tp, left = F) %>%
distinct(POLY_ID, .keep_all = T) %>%
st_union() %>%
st_cast("POLYGON") %>%
st_as_sf() %>%
mutate(CAST_ID = 1:nrow(.))
pt_grps <- st_intersection(pts, new_polys) %>%
group_by(CAST_ID)
center_windows <- function(x){
output <- x %>%
st_as_sf() %>%
st_union() %>%
st_convex_hull() %>%
st_transform(32613) %>%
st_buffer(1) %>%
st_cast('POLYGON') %>%
st_centroid() %>%
st_as_sf()
return(output)
}
#  babadook <- split(pt_grps, ~CAST_ID)
#  new_centers <- lapply(lapply(babadook, center_windows), pts_cell) %>% bind_rows()
#  return(new_centers)
}
lapply(pts, center_windows)
View(pts)
